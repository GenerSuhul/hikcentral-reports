{"ast":null,"code":"import emailjs from 'emailjs-com'; // üëà usa el SDK oficial m√°s estable\n\nconst SERVICE_ID = 'service_kjwa94s';\nconst TEMPLATE_ID = 'template_wdqmcgg';\nconst PUBLIC_KEY = 'x-IkhulHmUhyILb5a';\n\n// üì® Enviar correo con validaciones y logs\nexport const sendEmail = async templateParams => {\n  try {\n    // Validaci√≥n b√°sica\n    if (!templateParams.to_email || !templateParams.subject || !templateParams.contenido_html) {\n      console.error('‚ùó templateParams incompleto:', templateParams);\n      return {\n        success: false,\n        error: 'Faltan campos requeridos en templateParams.'\n      };\n    }\n\n    // Limpiar lista de correos\n    templateParams.to_email = templateParams.to_email.split(',').map(c => c.trim()).join(',');\n\n    // Logs √∫tiles para depuraci√≥n\n    console.log('üì§ Enviando correo a:', templateParams.to_email);\n    console.log('üßæ Asunto:', templateParams.subject);\n    console.log('üìÑ Contenido HTML (preview):', templateParams.contenido_html.slice(0, 300));\n\n    // Enviar el correo v√≠a EmailJS\n    const response = await emailjs.send(SERVICE_ID, TEMPLATE_ID, templateParams, PUBLIC_KEY // üëà clave p√∫blica va como cuarto argumento, no .init()\n    );\n    console.log('‚úÖ Email enviado correctamente:', response.status, response.text);\n    return {\n      success: true,\n      response\n    };\n  } catch (error) {\n    console.error('‚ùå Error al enviar correo:', error);\n    const errorMsg = typeof error === 'string' ? error : (error === null || error === void 0 ? void 0 : error.text) || (error === null || error === void 0 ? void 0 : error.message) || JSON.stringify(error);\n    return {\n      success: false,\n      error: errorMsg\n    };\n  }\n};\n\n// üßæ Generar tabla HTML para insertar en el correo\nexport const generateHtmlTable = data => {\n  if (!data || data.length === 0) {\n    return '<p>No hay datos para mostrar en la tabla.</p>';\n  }\n  const headers = ['Departamento', 'Grupo de asistencia', 'Nombre', 'Fecha', 'Hora real del registro de entrada', 'Hora real de registro de salida', 'Grabaci√≥n de asistencia', 'Duraci√≥n de la pausa', 'Registros de descansos', 'Periodo de tiempo'];\n  let tableHtml = `\n    <style>\n      table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-bottom: 20px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n      }\n      th, td {\n        border: 1px solid #dddddd;\n        text-align: left;\n        padding: 8px;\n      }\n      th {\n        background-color: #f2f2f2;\n        font-weight: bold;\n      }\n      tr:nth-child(even) {\n        background-color: #f9f9f9;\n      }\n    </style>\n    <table>\n      <thead>\n        <tr>\n  `;\n  headers.forEach(header => {\n    tableHtml += `<th>${header}</th>`;\n  });\n  tableHtml += `\n        </tr>\n      </thead>\n      <tbody>\n  `;\n  data.forEach(row => {\n    tableHtml += '<tr>';\n    headers.forEach(header => {\n      tableHtml += `<td>${row[header] || ''}</td>`;\n    });\n    tableHtml += '</tr>';\n  });\n  tableHtml += `\n      </tbody>\n    </table>\n  `;\n  return tableHtml;\n};","map":{"version":3,"names":["emailjs","SERVICE_ID","TEMPLATE_ID","PUBLIC_KEY","sendEmail","templateParams","to_email","subject","contenido_html","console","error","success","split","map","c","trim","join","log","slice","response","send","status","text","errorMsg","message","JSON","stringify","generateHtmlTable","data","length","headers","tableHtml","forEach","header","row"],"sources":["C:/Users/itagr/project/src/utils/emailService.js"],"sourcesContent":["import emailjs from 'emailjs-com'; // üëà usa el SDK oficial m√°s estable\n\nconst SERVICE_ID = 'service_kjwa94s';\nconst TEMPLATE_ID = 'template_wdqmcgg';\nconst PUBLIC_KEY = 'x-IkhulHmUhyILb5a';\n\n// üì® Enviar correo con validaciones y logs\nexport const sendEmail = async (templateParams) => {\n  try {\n    // Validaci√≥n b√°sica\n    if (\n      !templateParams.to_email ||\n      !templateParams.subject ||\n      !templateParams.contenido_html\n    ) {\n      console.error('‚ùó templateParams incompleto:', templateParams);\n      return { success: false, error: 'Faltan campos requeridos en templateParams.' };\n    }\n\n    // Limpiar lista de correos\n    templateParams.to_email = templateParams.to_email\n      .split(',')\n      .map(c => c.trim())\n      .join(',');\n\n    // Logs √∫tiles para depuraci√≥n\n    console.log('üì§ Enviando correo a:', templateParams.to_email);\n    console.log('üßæ Asunto:', templateParams.subject);\n    console.log('üìÑ Contenido HTML (preview):', templateParams.contenido_html.slice(0, 300));\n\n    // Enviar el correo v√≠a EmailJS\n    const response = await emailjs.send(\n      SERVICE_ID,\n      TEMPLATE_ID,\n      templateParams,\n      PUBLIC_KEY // üëà clave p√∫blica va como cuarto argumento, no .init()\n    );\n\n    console.log('‚úÖ Email enviado correctamente:', response.status, response.text);\n    return { success: true, response };\n\n  } catch (error) {\n    console.error('‚ùå Error al enviar correo:', error);\n    const errorMsg = typeof error === 'string'\n      ? error\n      : error?.text || error?.message || JSON.stringify(error);\n    return { success: false, error: errorMsg };\n  }\n};\n\n// üßæ Generar tabla HTML para insertar en el correo\nexport const generateHtmlTable = (data) => {\n  if (!data || data.length === 0) {\n    return '<p>No hay datos para mostrar en la tabla.</p>';\n  }\n\n  const headers = [\n    'Departamento',\n    'Grupo de asistencia',\n    'Nombre',\n    'Fecha',\n    'Hora real del registro de entrada',\n    'Hora real de registro de salida',\n    'Grabaci√≥n de asistencia',\n    'Duraci√≥n de la pausa',\n    'Registros de descansos',\n    'Periodo de tiempo'\n  ];\n\n  let tableHtml = `\n    <style>\n      table {\n        width: 100%;\n        border-collapse: collapse;\n        margin-bottom: 20px;\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n      }\n      th, td {\n        border: 1px solid #dddddd;\n        text-align: left;\n        padding: 8px;\n      }\n      th {\n        background-color: #f2f2f2;\n        font-weight: bold;\n      }\n      tr:nth-child(even) {\n        background-color: #f9f9f9;\n      }\n    </style>\n    <table>\n      <thead>\n        <tr>\n  `;\n\n  headers.forEach(header => {\n    tableHtml += `<th>${header}</th>`;\n  });\n\n  tableHtml += `\n        </tr>\n      </thead>\n      <tbody>\n  `;\n\n  data.forEach(row => {\n    tableHtml += '<tr>';\n    headers.forEach(header => {\n      tableHtml += `<td>${row[header] || ''}</td>`;\n    });\n    tableHtml += '</tr>';\n  });\n\n  tableHtml += `\n      </tbody>\n    </table>\n  `;\n\n  return tableHtml;\n};\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,aAAa,CAAC,CAAC;;AAEnC,MAAMC,UAAU,GAAG,iBAAiB;AACpC,MAAMC,WAAW,GAAG,kBAAkB;AACtC,MAAMC,UAAU,GAAG,mBAAmB;;AAEtC;AACA,OAAO,MAAMC,SAAS,GAAG,MAAOC,cAAc,IAAK;EACjD,IAAI;IACF;IACA,IACE,CAACA,cAAc,CAACC,QAAQ,IACxB,CAACD,cAAc,CAACE,OAAO,IACvB,CAACF,cAAc,CAACG,cAAc,EAC9B;MACAC,OAAO,CAACC,KAAK,CAAC,8BAA8B,EAAEL,cAAc,CAAC;MAC7D,OAAO;QAAEM,OAAO,EAAE,KAAK;QAAED,KAAK,EAAE;MAA8C,CAAC;IACjF;;IAEA;IACAL,cAAc,CAACC,QAAQ,GAAGD,cAAc,CAACC,QAAQ,CAC9CM,KAAK,CAAC,GAAG,CAAC,CACVC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAClBC,IAAI,CAAC,GAAG,CAAC;;IAEZ;IACAP,OAAO,CAACQ,GAAG,CAAC,uBAAuB,EAAEZ,cAAc,CAACC,QAAQ,CAAC;IAC7DG,OAAO,CAACQ,GAAG,CAAC,YAAY,EAAEZ,cAAc,CAACE,OAAO,CAAC;IACjDE,OAAO,CAACQ,GAAG,CAAC,8BAA8B,EAAEZ,cAAc,CAACG,cAAc,CAACU,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;;IAExF;IACA,MAAMC,QAAQ,GAAG,MAAMnB,OAAO,CAACoB,IAAI,CACjCnB,UAAU,EACVC,WAAW,EACXG,cAAc,EACdF,UAAU,CAAC;IACb,CAAC;IAEDM,OAAO,CAACQ,GAAG,CAAC,gCAAgC,EAAEE,QAAQ,CAACE,MAAM,EAAEF,QAAQ,CAACG,IAAI,CAAC;IAC7E,OAAO;MAAEX,OAAO,EAAE,IAAI;MAAEQ;IAAS,CAAC;EAEpC,CAAC,CAAC,OAAOT,KAAK,EAAE;IACdD,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACjD,MAAMa,QAAQ,GAAG,OAAOb,KAAK,KAAK,QAAQ,GACtCA,KAAK,GACL,CAAAA,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEY,IAAI,MAAIZ,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEc,OAAO,KAAIC,IAAI,CAACC,SAAS,CAAChB,KAAK,CAAC;IAC1D,OAAO;MAAEC,OAAO,EAAE,KAAK;MAAED,KAAK,EAAEa;IAAS,CAAC;EAC5C;AACF,CAAC;;AAED;AACA,OAAO,MAAMI,iBAAiB,GAAIC,IAAI,IAAK;EACzC,IAAI,CAACA,IAAI,IAAIA,IAAI,CAACC,MAAM,KAAK,CAAC,EAAE;IAC9B,OAAO,+CAA+C;EACxD;EAEA,MAAMC,OAAO,GAAG,CACd,cAAc,EACd,qBAAqB,EACrB,QAAQ,EACR,OAAO,EACP,mCAAmC,EACnC,iCAAiC,EACjC,yBAAyB,EACzB,sBAAsB,EACtB,wBAAwB,EACxB,mBAAmB,CACpB;EAED,IAAIC,SAAS,GAAG;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAEDD,OAAO,CAACE,OAAO,CAACC,MAAM,IAAI;IACxBF,SAAS,IAAI,OAAOE,MAAM,OAAO;EACnC,CAAC,CAAC;EAEFF,SAAS,IAAI;AACf;AACA;AACA;AACA,GAAG;EAEDH,IAAI,CAACI,OAAO,CAACE,GAAG,IAAI;IAClBH,SAAS,IAAI,MAAM;IACnBD,OAAO,CAACE,OAAO,CAACC,MAAM,IAAI;MACxBF,SAAS,IAAI,OAAOG,GAAG,CAACD,MAAM,CAAC,IAAI,EAAE,OAAO;IAC9C,CAAC,CAAC;IACFF,SAAS,IAAI,OAAO;EACtB,CAAC,CAAC;EAEFA,SAAS,IAAI;AACf;AACA;AACA,GAAG;EAED,OAAOA,SAAS;AAClB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}