{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\itagr\\\\project\\\\src\\\\components\\\\FileUpload.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { UploadCloud, FileText, Send, CheckCircle, XCircle, Loader2, AlertTriangle } from 'lucide-react';\nimport { parseExcelFile, extractBranchCode } from '../utils/excelParser';\nimport { fetchBranches, fetchBranchContacts } from '../utils/supabase';\nimport { sendEmail, generateHtmlTable } from '../utils/emailService';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst FileUpload = () => {\n  _s();\n  const [file, setFile] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [results, setResults] = useState(null);\n  const [error, setError] = useState(null);\n  const handleFileChange = e => {\n    setFile(e.target.files[0]);\n    setResults(null);\n    setError(null);\n  };\n  const handleProcessFile = async () => {\n    if (!file) {\n      setError('Por favor, selecciona un archivo Excel primero.');\n      return;\n    }\n    setProcessing(true);\n    setResults(null);\n    setError(null);\n    try {\n      const parsedData = await parseExcelFile(file);\n      if (parsedData.length === 0) {\n        setError('El archivo Excel no contiene datos válidos o no se encontró el encabezado.');\n        setProcessing(false);\n        return;\n      }\n      const branchesData = await fetchBranches();\n      const branchMap = new Map(branchesData.map(b => [b.code, b.id]));\n      const groupedByBranch = {};\n      parsedData.forEach(record => {\n        const department = record['Departamento'];\n        const branchCode = extractBranchCode(department);\n        if (branchCode) {\n          if (!groupedByBranch[branchCode]) {\n            groupedByBranch[branchCode] = [];\n          }\n          groupedByBranch[branchCode].push(record);\n        } else {\n          console.warn(`Registro omitido: No se pudo extraer el código de sucursal de \"${department}\"`);\n        }\n      });\n      const emailResults = {\n        detectedBranches: Object.keys(groupedByBranch).length,\n        sentEmails: [],\n        errors: [],\n        warnings: []\n      };\n      for (const branchCode in groupedByBranch) {\n        const branchId = branchMap.get(branchCode);\n        if (!branchId) {\n          emailResults.warnings.push(`Sucursal con código '${branchCode}' detectada en el Excel pero no encontrada en la base de datos. No se enviarán correos para esta sucursal.`);\n          continue;\n        }\n        const contacts = await fetchBranchContacts(branchId);\n        if (contacts.length === 0) {\n          emailResults.warnings.push(`No se encontraron contactos para la sucursal '${branchCode}'. No se enviarán correos.`);\n          continue;\n        }\n        const recipientEmails = contacts.map(c => c.email);\n        const htmlContent = generateHtmlTable(groupedByBranch[branchCode]);\n        const subject = `Reporte Diario – ${branchCode}`;\n        const templateParams = {\n          to_email: recipientEmails.join(','),\n          // EmailJS puede manejar múltiples destinatarios separados por coma\n          subject: subject,\n          html_content: htmlContent\n        };\n        const emailResponse = await sendEmail(templateParams);\n        if (emailResponse.success) {\n          emailResults.sentEmails.push({\n            branchCode,\n            recipients: recipientEmails,\n            status: 'Enviado'\n          });\n        } else {\n          emailResults.errors.push({\n            branchCode,\n            recipients: recipientEmails,\n            error: emailResponse.error.message || 'Error desconocido al enviar correo'\n          });\n        }\n      }\n      setResults(emailResults);\n    } catch (err) {\n      setError('Error al procesar el archivo: ' + err.message);\n      console.error(err);\n    } finally {\n      setProcessing(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    className: \"bg-white/80 backdrop-blur-xl border border-gray-200/50 rounded-3xl p-8 shadow-xl\",\n    initial: {\n      opacity: 0,\n      y: 20\n    },\n    animate: {\n      opacity: 1,\n      y: 0\n    },\n    transition: {\n      duration: 0.5\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3\",\n      children: [/*#__PURE__*/_jsxDEV(UploadCloud, {\n        className: \"w-8 h-8 text-blue-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), \"Cargar y Enviar Reporte HikCentral\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"excel-upload\",\n        className: \"block text-gray-700 text-lg font-medium mb-2\",\n        children: \"Selecciona tu archivo de reporte Excel:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        id: \"excel-upload\",\n        accept: \".xlsx, .xls\",\n        onChange: handleFileChange,\n        className: \"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this), file && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-2 text-gray-600 flex items-center gap-2\",\n        children: [/*#__PURE__*/_jsxDEV(FileText, {\n          className: \"w-4 h-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 13\n        }, this), \"Archivo seleccionado: \", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: file.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 35\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(motion.button, {\n      onClick: handleProcessFile,\n      disabled: !file || processing,\n      className: `w-full px-6 py-3 rounded-xl font-semibold text-lg flex items-center justify-center gap-3 transition-all duration-300 ${file && !processing ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg hover:shadow-xl hover:scale-105' : 'bg-gray-200 text-gray-400 cursor-not-allowed'}`,\n      whileHover: file && !processing ? {\n        scale: 1.02\n      } : {},\n      whileTap: file && !processing ? {\n        scale: 0.98\n      } : {},\n      children: processing ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Loader2, {\n          className: \"w-6 h-6 animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 13\n        }, this), \"Procesando y Enviando...\"]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Send, {\n          className: \"w-6 h-6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 13\n        }, this), \"Procesar y Enviar Reportes\"]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AnimatePresence, {\n      children: [error && /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0,\n          y: -20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        exit: {\n          opacity: 0,\n          y: -20\n        },\n        className: \"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl relative mt-6 flex items-center gap-2\",\n        role: \"alert\",\n        children: [/*#__PURE__*/_jsxDEV(XCircle, {\n          className: \"w-5 h-5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"block sm:inline\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 11\n      }, this), results && /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        transition: {\n          duration: 0.5,\n          delay: 0.2\n        },\n        className: \"mt-8 p-6 bg-blue-50 border border-blue-200 rounded-xl shadow-md\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-2xl font-bold text-blue-800 mb-4 flex items-center gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n            className: \"w-7 h-7 text-blue-600\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 15\n          }, this), \"Resumen del Proceso\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-700 mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-semibold\",\n            children: \"Sucursales detectadas en el Excel:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 15\n          }, this), \" \", results.detectedBranches]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this), results.sentEmails.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-lg font-semibold text-green-700 mb-2 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(CheckCircle, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 19\n            }, this), \"Correos Enviados Exitosamente:\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"list-disc list-inside text-gray-700\",\n            children: results.sentEmails.map((res, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-medium\",\n                children: [res.branchCode, \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 23\n              }, this), \" a \", res.recipients.join(', ')]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 15\n        }, this), results.warnings.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-lg font-semibold text-yellow-700 mb-2 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 19\n            }, this), \"Advertencias:\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"list-disc list-inside text-gray-700\",\n            children: results.warnings.map((warn, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"text-yellow-800\",\n              children: warn\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 15\n        }, this), results.errors.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-lg font-semibold text-red-700 mb-2 flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(XCircle, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 19\n            }, this), \"Errores al Enviar Correos:\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            className: \"list-disc list-inside text-gray-700\",\n            children: results.errors.map((err, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"text-red-800\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-medium\",\n                children: [err.branchCode, \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 23\n              }, this), \" a \", err.recipients.join(', '), \" - \", err.error]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 5\n  }, this);\n};\n_s(FileUpload, \"nClVbIDV1Wc7hqBjCUdWJVv4B0w=\");\n_c = FileUpload;\nexport default FileUpload;\nvar _c;\n$RefreshReg$(_c, \"FileUpload\");","map":{"version":3,"names":["React","useState","motion","AnimatePresence","UploadCloud","FileText","Send","CheckCircle","XCircle","Loader2","AlertTriangle","parseExcelFile","extractBranchCode","fetchBranches","fetchBranchContacts","sendEmail","generateHtmlTable","jsxDEV","_jsxDEV","Fragment","_Fragment","FileUpload","_s","file","setFile","processing","setProcessing","results","setResults","error","setError","handleFileChange","e","target","files","handleProcessFile","parsedData","length","branchesData","branchMap","Map","map","b","code","id","groupedByBranch","forEach","record","department","branchCode","push","console","warn","emailResults","detectedBranches","Object","keys","sentEmails","errors","warnings","branchId","get","contacts","recipientEmails","c","email","htmlContent","subject","templateParams","to_email","join","html_content","emailResponse","success","recipients","status","message","err","div","className","initial","opacity","y","animate","transition","duration","children","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","type","accept","onChange","name","button","onClick","disabled","whileHover","scale","whileTap","exit","role","delay","res","index","_c","$RefreshReg$"],"sources":["C:/Users/itagr/project/src/components/FileUpload.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { UploadCloud, FileText, Send, CheckCircle, XCircle, Loader2, AlertTriangle } from 'lucide-react';\nimport { parseExcelFile, extractBranchCode } from '../utils/excelParser';\nimport { fetchBranches, fetchBranchContacts } from '../utils/supabase';\nimport { sendEmail, generateHtmlTable } from '../utils/emailService';\n\nconst FileUpload = () => {\n  const [file, setFile] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [results, setResults] = useState(null);\n  const [error, setError] = useState(null);\n\n  const handleFileChange = (e) => {\n    setFile(e.target.files[0]);\n    setResults(null);\n    setError(null);\n  };\n\n  const handleProcessFile = async () => {\n    if (!file) {\n      setError('Por favor, selecciona un archivo Excel primero.');\n      return;\n    }\n\n    setProcessing(true);\n    setResults(null);\n    setError(null);\n\n    try {\n      const parsedData = await parseExcelFile(file);\n      if (parsedData.length === 0) {\n        setError('El archivo Excel no contiene datos válidos o no se encontró el encabezado.');\n        setProcessing(false);\n        return;\n      }\n\n      const branchesData = await fetchBranches();\n      const branchMap = new Map(branchesData.map(b => [b.code, b.id]));\n\n      const groupedByBranch = {};\n      parsedData.forEach(record => {\n        const department = record['Departamento'];\n        const branchCode = extractBranchCode(department);\n\n        if (branchCode) {\n          if (!groupedByBranch[branchCode]) {\n            groupedByBranch[branchCode] = [];\n          }\n          groupedByBranch[branchCode].push(record);\n        } else {\n          console.warn(`Registro omitido: No se pudo extraer el código de sucursal de \"${department}\"`);\n        }\n      });\n\n      const emailResults = {\n        detectedBranches: Object.keys(groupedByBranch).length,\n        sentEmails: [],\n        errors: [],\n        warnings: []\n      };\n\n      for (const branchCode in groupedByBranch) {\n        const branchId = branchMap.get(branchCode);\n        if (!branchId) {\n          emailResults.warnings.push(`Sucursal con código '${branchCode}' detectada en el Excel pero no encontrada en la base de datos. No se enviarán correos para esta sucursal.`);\n          continue;\n        }\n\n        const contacts = await fetchBranchContacts(branchId);\n        if (contacts.length === 0) {\n          emailResults.warnings.push(`No se encontraron contactos para la sucursal '${branchCode}'. No se enviarán correos.`);\n          continue;\n        }\n\n        const recipientEmails = contacts.map(c => c.email);\n        const htmlContent = generateHtmlTable(groupedByBranch[branchCode]);\n        const subject = `Reporte Diario – ${branchCode}`;\n\n        const templateParams = {\n          to_email: recipientEmails.join(','), // EmailJS puede manejar múltiples destinatarios separados por coma\n          subject: subject,\n          html_content: htmlContent,\n        };\n\n        const emailResponse = await sendEmail(templateParams);\n\n        if (emailResponse.success) {\n          emailResults.sentEmails.push({\n            branchCode,\n            recipients: recipientEmails,\n            status: 'Enviado'\n          });\n        } else {\n          emailResults.errors.push({\n            branchCode,\n            recipients: recipientEmails,\n            error: emailResponse.error.message || 'Error desconocido al enviar correo'\n          });\n        }\n      }\n\n      setResults(emailResults);\n\n    } catch (err) {\n      setError('Error al procesar el archivo: ' + err.message);\n      console.error(err);\n    } finally {\n      setProcessing(false);\n    }\n  };\n\n  return (\n    <motion.div\n      className=\"bg-white/80 backdrop-blur-xl border border-gray-200/50 rounded-3xl p-8 shadow-xl\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.5 }}\n    >\n      <h2 className=\"text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3\">\n        <UploadCloud className=\"w-8 h-8 text-blue-600\" />\n        Cargar y Enviar Reporte HikCentral\n      </h2>\n\n      <div className=\"mb-6\">\n        <label htmlFor=\"excel-upload\" className=\"block text-gray-700 text-lg font-medium mb-2\">\n          Selecciona tu archivo de reporte Excel:\n        </label>\n        <input\n          type=\"file\"\n          id=\"excel-upload\"\n          accept=\".xlsx, .xls\"\n          onChange={handleFileChange}\n          className=\"block w-full text-sm text-gray-500\n            file:mr-4 file:py-2 file:px-4\n            file:rounded-full file:border-0\n            file:text-sm file:font-semibold\n            file:bg-blue-50 file:text-blue-700\n            hover:file:bg-blue-100\"\n        />\n        {file && (\n          <p className=\"mt-2 text-gray-600 flex items-center gap-2\">\n            <FileText className=\"w-4 h-4\" />\n            Archivo seleccionado: <span className=\"font-medium\">{file.name}</span>\n          </p>\n        )}\n      </div>\n\n      <motion.button\n        onClick={handleProcessFile}\n        disabled={!file || processing}\n        className={`w-full px-6 py-3 rounded-xl font-semibold text-lg flex items-center justify-center gap-3 transition-all duration-300 ${\n          file && !processing\n            ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg hover:shadow-xl hover:scale-105'\n            : 'bg-gray-200 text-gray-400 cursor-not-allowed'\n        }`}\n        whileHover={file && !processing ? { scale: 1.02 } : {}}\n        whileTap={file && !processing ? { scale: 0.98 } : {}}\n      >\n        {processing ? (\n          <>\n            <Loader2 className=\"w-6 h-6 animate-spin\" />\n            Procesando y Enviando...\n          </>\n        ) : (\n          <>\n            <Send className=\"w-6 h-6\" />\n            Procesar y Enviar Reportes\n          </>\n        )}\n      </motion.button>\n\n      <AnimatePresence>\n        {error && (\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n            className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl relative mt-6 flex items-center gap-2\"\n            role=\"alert\"\n          >\n            <XCircle className=\"w-5 h-5\" />\n            <span className=\"block sm:inline\">{error}</span>\n          </motion.div>\n        )}\n\n        {results && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.2 }}\n            className=\"mt-8 p-6 bg-blue-50 border border-blue-200 rounded-xl shadow-md\"\n          >\n            <h3 className=\"text-2xl font-bold text-blue-800 mb-4 flex items-center gap-2\">\n              <CheckCircle className=\"w-7 h-7 text-blue-600\" />\n              Resumen del Proceso\n            </h3>\n            <p className=\"text-gray-700 mb-2\">\n              <span className=\"font-semibold\">Sucursales detectadas en el Excel:</span> {results.detectedBranches}\n            </p>\n\n            {results.sentEmails.length > 0 && (\n              <div className=\"mt-4\">\n                <h4 className=\"text-lg font-semibold text-green-700 mb-2 flex items-center gap-2\">\n                  <CheckCircle className=\"w-5 h-5\" />\n                  Correos Enviados Exitosamente:\n                </h4>\n                <ul className=\"list-disc list-inside text-gray-700\">\n                  {results.sentEmails.map((res, index) => (\n                    <li key={index}>\n                      <span className=\"font-medium\">{res.branchCode}:</span> a {res.recipients.join(', ')}\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {results.warnings.length > 0 && (\n              <div className=\"mt-4\">\n                <h4 className=\"text-lg font-semibold text-yellow-700 mb-2 flex items-center gap-2\">\n                  <AlertTriangle className=\"w-5 h-5\" />\n                  Advertencias:\n                </h4>\n                <ul className=\"list-disc list-inside text-gray-700\">\n                  {results.warnings.map((warn, index) => (\n                    <li key={index} className=\"text-yellow-800\">{warn}</li>\n                  ))}\n                </ul>\n              </div>\n            )}\n\n            {results.errors.length > 0 && (\n              <div className=\"mt-4\">\n                <h4 className=\"text-lg font-semibold text-red-700 mb-2 flex items-center gap-2\">\n                  <XCircle className=\"w-5 h-5\" />\n                  Errores al Enviar Correos:\n                </h4>\n                <ul className=\"list-disc list-inside text-gray-700\">\n                  {results.errors.map((err, index) => (\n                    <li key={index} className=\"text-red-800\">\n                      <span className=\"font-medium\">{err.branchCode}:</span> a {err.recipients.join(', ')} - {err.error}\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n};\n\nexport default FileUpload;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}